# BT价格监控程序

监控币安BT价格变化，当价格涨跌超过500美元时发送企业微信提醒。

## 功能特点

- ✅ 实时监控BT价格（从币安API获取）
- ✅ 只在价格涨跌超过500美元时发送提醒
- ✅ 显示当前价格和涨跌比例
- ✅ 追踪今日最高价和最低价
- ✅ 检测今日是否有超过2000美元的涨跌，并记录出现时间（北京时间）
- ✅ 企业微信消息推送（使用"BT"代替敏感词汇）

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 配置企业微信

#### 2.1 创建企业微信群机器人

1. 在企业微信中创建一个群聊
2. 点击群设置 → 群机器人 → 添加机器人
3. 复制 Webhook URL（格式类似：`https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=xxxxx`）

#### 2.2 配置 Webhook URL

有两种方式配置：

**方式1：环境变量（推荐）**
```bash
# Windows PowerShell
$env:WECHAT_WEBHOOK_URL="你的Webhook URL"

# Linux/Mac
export WECHAT_WEBHOOK_URL="你的Webhook URL"
```

**方式2：修改代码**
编辑 `btc_price_monitor.py`，找到：
```python
WECHAT_WEBHOOK_URL = os.getenv('WECHAT_WEBHOOK_URL', '')
```
改为：
```python
WECHAT_WEBHOOK_URL = os.getenv('WECHAT_WEBHOOK_URL', '你的Webhook URL')
```

### 3. 运行程序

```bash
python btc_price_monitor.py
```

程序会持续运行，每30秒检查一次价格（可在代码中修改 `CHECK_INTERVAL_SECONDS`）。

## 配置说明

### 价格变化提醒阈值

默认只提醒超过500美元的涨跌。可以在代码中修改：

```python
PRICE_CHANGE_THRESHOLD = 500  # 涨跌超过此金额时提醒（美元）
```

### 检查间隔

默认每30秒检查一次。可以在代码中修改：

```python
CHECK_INTERVAL_SECONDS = 30  # 秒
```

### 今日最大涨跌阈值

默认检测超过2000美元的涨跌。可以在代码中修改：

```python
DAILY_MAX_CHANGE_THRESHOLD = 2000  # 美元
```

## 消息格式

当价格涨跌超过500美元时，会收到如下格式的企业微信消息：

```
# 📈 BT价格提醒

🕐 更新时间（北京时间）: 2024-01-01 12:00:00

## 💰 当前价格
$45,000.00

## 📊 价格变化
上涨 $750.00 (+1.67%)

## 📈 今日价格区间
• 最高价: $45,500.00 (14:30)
• 最低价: $44,200.00 (09:15)
• 今日最大涨跌: $2,500.00 (超过$2,000.00阈值)

## ⚠️ 今日超过2000美元涨跌记录
• 最高价 $45,500.00 (涨跌$2,500.00) - 2024-01-01 14:30
• 最低价 $44,200.00 (涨跌$2,500.00) - 2024-01-01 09:15

⚠️ 本程序仅用于信息提醒，不做任何交易决策
```

## 状态文件

程序会在运行目录下创建 `btc_price_state.json` 文件，用于保存：
- 上次检查的价格
- 今日最高价和最低价
- 今日最高价和最低价出现时间
- 上次提醒时的价格
- 今日超过2000美元涨跌的事件记录

每天会自动重置今日数据。

## 注意事项

1. **价格基准**：提醒基于"上次提醒时的价格"，不是"上次检查时的价格"
2. **提醒阈值**：只提醒超过500美元的涨跌，小于500美元不会提醒
3. **今日数据**：每天0点（北京时间）自动重置今日最高最低价
4. **敏感词汇**：消息中使用"BT"代替"BTC"和"比特币"
5. **免责声明**：本程序仅用于信息提醒，不做任何交易决策

## 常见问题

### Q: 为什么没有收到提醒？
A: 检查以下几点：
- 价格变化是否超过500美元
- 企业微信 Webhook URL 是否正确配置
- 程序是否正常运行

### Q: 如何修改提醒阈值？
A: 编辑 `btc_price_monitor.py`，修改 `PRICE_CHANGE_THRESHOLD` 的值。

### Q: 程序可以24小时运行吗？
A: 可以，但建议在服务器或云主机上运行，确保网络稳定。

## 技术支持

如有问题，请检查：
1. Python版本（建议3.7+）
2. 网络连接（需要访问币安API）
3. 企业微信 Webhook URL 是否有效

---

⚠️ **免责声明**：本程序仅用于信息提醒，不做任何交易决策。投资有风险，入市需谨慎。
